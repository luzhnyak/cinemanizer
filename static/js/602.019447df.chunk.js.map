{"version":3,"file":"static/js/602.019447df.chunk.js","mappings":"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","sources":["pages/MovieDetailsPage.jsx"],"sourcesContent":["import { Suspense, useEffect, useRef } from 'react';\nimport { Outlet, useParams, NavLink, useLocation } from 'react-router-dom';\n\nimport { Back } from 'components/Back/Back';\nimport { Loader } from 'components/Loader/Loader';\n\nimport noPoster from '../images/no-poster.jpg';\nimport { useFetchMovieByIdQuery } from 'redux/api';\nimport toast from 'react-hot-toast';\nimport { Button } from 'react-bootstrap';\n\nimport { getDatabase, ref, set } from 'firebase/database';\n// import { getAuth } from 'firebase/auth';\n// import { app } from '../firebase-api';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { addMovie, deleteMovie } from 'redux/watchlistSlice';\n\nconst MovieDetails = () => {\n  const dispatch = useDispatch();\n  const { movieId } = useParams();\n  const location = useLocation();\n\n  const backLinkLocationRef = useRef(location.state?.from ?? '/movies');\n\n  const { data, isLoading, error } = useFetchMovieByIdQuery(movieId, {\n    skip: !movieId,\n  });\n\n  const { id } = useSelector(state => state.user);\n\n  const movie = data ?? {};\n\n  const { movies } = useSelector(state => state.watchlist);\n\n  const isWatchlist = movies?.some(m => m.id === movie.id);\n\n  // Виводимо помилку\n  useEffect(() => {\n    if (error) toast.error(error.data.message);\n  }, [error]);\n\n  useEffect(() => {\n    function writeUserData(movies) {\n      if (!id) return;\n      const db = getDatabase();\n      // const auth = getAuth(app);\n      // const userId = auth?.currentUser?.uid;\n      // console.log('add start', userId);\n\n      set(ref(db, 'users/' + id), {\n        movies: movies,\n      });\n      // console.log('add end');\n    }\n\n    if (movies) {\n      writeUserData(movies);\n    }\n  }, [movies, id]);\n\n  const { title, poster_path, vote_average, overview, genres, release_date } =\n    movie;\n\n  const handleAddToWatchlist = () => {\n    if (isWatchlist) {\n      dispatch(deleteMovie(movie.id));\n    } else {\n      dispatch(addMovie(movie));\n    }\n  };\n\n  if (isLoading) {\n    return <Loader />;\n  }\n\n  return (\n    <div className=\"mb-4\">\n      <Back backLinkLocationRef={backLinkLocationRef.current} />\n      <div className=\"row\">\n        <div className=\"col-4\">\n          <img\n            src={\n              poster_path\n                ? `https://image.tmdb.org/t/p/w300/${poster_path}`\n                : noPoster\n            }\n            className=\"card-img-top\"\n            alt={title}\n          />\n          {id && (\n            <Button className=\"mt-3 w-100\" onClick={handleAddToWatchlist}>\n              {isWatchlist ? 'Remove from watchlist' : 'Add to watchlist'}\n            </Button>\n          )}\n        </div>\n        <div className=\"col-8\">\n          <h1>{title}</h1>\n          <p>\n            <b>User Score:</b> {Math.round(vote_average * 10)} %\n          </p>\n          <p>\n            <b>Release date:</b> {release_date}\n          </p>\n\n          <h3>Overview</h3>\n          <p>{overview}</p>\n          <h3>Genres</h3>\n          <div>\n            {genres &&\n              genres.map(({ id, name }) => {\n                return <span key={id}>{name} </span>;\n              })}\n          </div>\n        </div>\n      </div>\n\n      <h2 className=\"mt-3 mb-3\">Additional Information</h2>\n\n      <ul className=\"nav nav-tabs\">\n        <li className=\"nav-item\">\n          <NavLink className=\"nav-link\" aria-current=\"page\" to=\"cast\">\n            Cast\n          </NavLink>\n        </li>\n        <li className=\"nav-item\">\n          <NavLink className=\"nav-link\" aria-current=\"page\" to=\"reviews\">\n            Reviews\n          </NavLink>\n        </li>\n        <li className=\"nav-item\">\n          <NavLink className=\"nav-link\" aria-current=\"page\" to=\"videos\">\n            Videos\n          </NavLink>\n        </li>\n      </ul>\n\n      <Suspense fallback={<Loader />}>\n        <Outlet />\n      </Suspense>\n    </div>\n  );\n};\n\nexport default MovieDetails;\n"],"names":["_location$state$from","_location$state","dispatch","useDispatch","movieId","useParams","location","useLocation","backLinkLocationRef","useRef","state","from","_useFetchMovieByIdQue","useFetchMovieByIdQuery","skip","data","isLoading","error","id","useSelector","user","movie","movies","watchlist","isWatchlist","some","m","useEffect","toast","message","db","getDatabase","set","ref","writeUserData","title","poster_path","vote_average","overview","genres","release_date","_jsx","Loader","_jsxs","className","children","Back","current","src","concat","noPoster","alt","Button","onClick","deleteMovie","addMovie","Math","round","map","_ref","name","NavLink","to","Suspense","fallback","Outlet"],"sourceRoot":""}